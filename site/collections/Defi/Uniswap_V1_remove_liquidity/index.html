<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>What is a liquidity pool? - Harry's Blog</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "What is a liquidity pool?", url: "#_top", children: [
              {title: "Liquidity Pool l\u00e0 g\u00ec?", url: "#liquidity-pool-la-gi" },
              {title: "LP Token l\u00e0 g\u00ec?", url: "#lp-token-la-gi" },
          ]},
          {title: "Ai l\u00e0 Liquidity Provider (LP-er)?", url: "#ai-la-liquidity-provider-lp-er", children: [
          ]},
          {title: "Calculation principle of proportional extraction", url: "#calculation-principle-of-proportional-extraction", children: [
              {title: "\u2753T\u1ea1i sao ph\u1ea3i h\u1ee7y (burn) LP token?", url: "#tai-sao-phai-huy-burn-lp-token" },
              {title: "Slippage (Tr\u01b0\u1ee3t gi\u00e1) l\u00e0 g\u00ec?", url: "#slippage-truot-gia-la-gi" },
              {title: "C\u01a1 ch\u1ebf b\u1ea3o v\u1ec7 slippage ho\u1ea1t \u0111\u1ed9ng nh\u01b0 th\u1ebf n\u00e0o?", url: "#co-che-bao-ve-slippage-hoat-ong-nhu-the-nao" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../search/main.js"></script> 


  <link rel="stylesheet" href="../../../css/extra.css">
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav">
      <a href="../ERC-6551%20Token%20Bound%20Accounts/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../ERC-6551%20Token%20Bound%20Accounts/" class="btn btn-xs btn-link">
        ERC-6551 Token Bound Accounts
      </a>
    </div>
    
  </div>

    

    <h1 id="what-is-a-liquidity-pool">What is a liquidity pool?</h1>
<blockquote>
<p>What is a liquidity pool?</p>
</blockquote>
<p>Uniswap ho·∫°t ƒë·ªông kh√¥ng gi·ªëng s√†n t·∫≠p trung (CEX). N√≥ kh√¥ng c√≥ order book. Thay v√†o ƒë√≥, n√≥ d√πng m·ªôt th·ª© g·ªçi l√† liquidity pool n∆°i m√† ng∆∞·ªùi d√πng ( liquidity provider) ƒë·ªï c·∫£ ETH v√† token v√†o ƒë·ªÉ ng∆∞·ªùi kh√°c swap qua l·∫°i.</p>
<h2 id="liquidity-pool-la-gi">Liquidity Pool l√† g√¨?</h2>
<p><code>Liquidity Pool (LP)</code> l√† m·ªôt smart contract ch·ª©a hai lo·∫°i t√†i s·∫£n (vd: ETH v√† DAI). Ai c≈©ng c√≥ th·ªÉ swap qua l·∫°i gi·ªØa 2 token n√†y trong pool, kh√¥ng c·∫ßn order book, kh√¥ng c·∫ßn matching engine.</p>
<h2 id="lp-token-la-gi">LP Token l√† g√¨?</h2>
<p>Khi  th√™m thanh kho·∫£n v√†o pool, Uniswap s·∫Ω mint ra <code>LP token</code> ƒë·ªÉ ch·ª©ng nh·∫≠n r·∫±ng:</p>
<blockquote>
<p>‚ÄúYou now own a piece of the pool, homie.‚Äù üí∏</p>
</blockquote>
<p>LP token gi·ªëng v√© x√°c nh·∫≠n quy·ªÅn s·ªü h·ªØu. T·∫•t nhi√™n LP c≈©ng l√† token chu·∫©n ERC-20 n√™n b·∫°n c√≥ th·ªÉ chuy·ªÉn nh∆∞·ª£ng, b√°n, farm, ho·∫∑c c·∫ßm ƒëi th·∫ø ch·∫•p n·∫øu protocol n√†o ƒë√≥ cho ph√©p.</p>
<blockquote>
<p>‚ÄºÔ∏è N·∫øu b·∫°n chuy·ªÉn LP token cho ng∆∞·ªùi kh√°c, t·ª©c l√† b·∫°n ƒë√£ chuy·ªÉn quy·ªÅn s·ªü h·ªØu pool cho h·ªç lu√¥n. H·ªç c√≥ th·ªÉ r√∫t ETH v√† token ra thay b·∫°n ü´†</p>
</blockquote>
<h1 id="ai-la-liquidity-provider-lp-er">Ai l√† Liquidity Provider (LP-er)?</h1>
<p>L√† ng∆∞·ªùi ch∆°i ch·ªãu b·ªè ETH v√† token (c√πng gi√° tr·ªã) v√†o pool. Khi swapper swap token trong pool ‚Üí LP-er nh·∫≠n ƒë∆∞·ª£c ph√≠ giao d·ªãch (0.3%/swap tr√™n V1).</p>
<pre><code class="language-solidity">/**
 * @notice Remove liquidity, burn LP tokens, and retrieve ETH and tokens proportionally
 * @param amount The amount of LP tokens to burn
 * @param min_eth The minimum amount of ETH expected to receive
 * @param min_tokens The minimum amount of tokens expected to receive
 * @param deadline The transaction deadline (timestamp)
 * @return The actual amounts of ETH and tokens withdrawn
 */
function removeLiquidity(
    uint256 amount,
    uint256 min_eth,
    uint256 min_tokens,
    uint256 deadline
) external returns (uint256, uint256) {
    // Validate input parameters
    require(amount &gt; 0, &quot;Factory: INVALID_AMOUNT&quot;); // LP token amount must be greater than 0
    require(deadline &gt;= block.timestamp, &quot;Factory: DEADLINE_EXCEEDED&quot;); // Ensure the transaction hasn't expired

    // Get the total current liquidity
    uint256 totalLiquidity = totalSupply;
    require(totalLiquidity &gt; 0, &quot;Factory: EMPTY_LIQUIDITY&quot;); // Ensure there is liquidity in the pool

    // Calculate the amount of ETH and tokens to return proportionally
    uint256 tokenReserve = IERC20(token).balanceOf(address(this)); // Get the current token balance in the contract
    uint256 ethWithdrawn = (amount * address(this).balance) / totalLiquidity; // Proportional ETH to return
    uint256 tokenWithdrawn = (amount * tokenReserve) / totalLiquidity; // Proportional token to return

    // Ensure the returned amounts meet the minimum expected values (to prevent slippage)
    require(ethWithdrawn &gt;= min_eth, &quot;Factory: ETH_UNDERFLOW&quot;);
    require(tokenWithdrawn &gt;= min_tokens, &quot;Factory: TOKEN_UNDERFLOW&quot;);

    // Burn the user's LP tokens using inherited _burn function
    _burn(msg.sender, amount);

    // Safely send ETH back to the user
    (bool success, ) = msg.sender.call{value: ethWithdrawn}(&quot;&quot;);
    require(success, &quot;Factory: ETH_TRANSFER_FAILED&quot;); // Ensure ETH transfer succeeds

    // Send tokens back to the user
    require(IERC20(token).transfer(msg.sender, tokenWithdrawn), &quot;Factory: TOKEN_TRANSFER_FAILED&quot;);

    // Emit the RemoveLiquidity event
    emit RemoveLiquidity(msg.sender, ethWithdrawn, tokenWithdrawn);

    // Return the actual amounts of ETH and tokens withdrawn
    return (ethWithdrawn, tokenWithdrawn);
}
</code></pre>
<h1 id="calculation-principle-of-proportional-extraction">Calculation principle of proportional extraction</h1>
<p>Uniswap V1 s·ª≠ d·ª•ng nguy√™n t·∫Øc c·ªët l√µi l√† <em>ph√¢n ph·ªëi theo t·ª∑ l·ªá</em>:</p>
<p>C√¥ng th·ª©c t√≠nh:
* S·ªë ETH c√≥ th·ªÉ r√∫t = (S·ªë l∆∞·ª£ng LP token ng∆∞·ªùi d√πng n·∫Øm / T·ªïng s·ªë LP token trong pool) √ó T·ªïng l∆∞·ª£ng ETH trong pool</p>
<blockquote>
<p>S·ªë token c√≥ th·ªÉ r√∫t = (S·ªë l∆∞·ª£ng LP token ng∆∞·ªùi d√πng n·∫Øm / T·ªïng s·ªë LP token trong pool) √ó T·ªïng l∆∞·ª£ng token trong pool</p>
</blockquote>
<p>V√≠ d·ª• c·ª• th·ªÉ:</p>
<p>Gi·∫£ s·ª≠ tr·∫°ng th√°i hi·ªán t·∫°i c·ªßa pool l√†:
* T·ªïng c·ªông c√≥ 1000 LP token
* Pool ch·ª©a 10 ETH
* Pool c√≥ 20,000 USDC
* M√¨nh ƒëang n·∫Øm 100 LP token (t·ª©c l√† chi·∫øm 10% t·ªïng pool)</p>
<p>V·∫≠y m√¨nh c√≥ th·ªÉ r√∫t: 
* ETH: 100 √∑ 1000 √ó 10 = 1 ETH
* USDC: 100 √∑ 1000 √ó 20000 = 2000 USDC</p>
<blockquote>
<p>C∆° ch·∫ø n√†y ƒë·∫£m b·∫£o r·∫±ng ng∆∞·ªùi cung c·∫•p thanh kho·∫£n s·∫Ω nh·∫≠n l·∫°i l∆∞·ª£ng t√†i s·∫£n t∆∞∆°ng ·ª©ng v·ªõi t·ª∑ l·ªá ƒë√≥ng g√≥p c·ªßa m√¨nh, bao g·ªìm c·∫£ ph·∫ßn ph√≠ giao d·ªãch ƒë√£ t√≠ch l≈©y trong qu√° kh·ª©.</p>
</blockquote>
<h2 id="tai-sao-phai-huy-burn-lp-token">‚ùìT·∫°i sao ph·∫£i h·ªßy (burn) LP token?</h2>
<p>Nh∆∞ ƒë·ªÅ c·∫≠p ·ªü tr√™n, LP token l√† ch·ª©ng ch·ªâ th·ªÉ hi·ªán ph·∫ßn s·ªü h·ªØu c·ªßa m√¨nh trong pool.</p>
<p>Khi  r√∫t thanh kho·∫£n, LP token ph·∫£i ƒë∆∞·ª£c ti√™u h·ªßy ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh to√°n ph·∫ßn trƒÉm s·ªü h·ªØu c√≤n l·∫°i c·ªßa c√°c LP kh√°c l√† ch√≠nh x√°c. Ngo√†i ra ngƒÉn vi·ªác  LP token b·ªã t√°i s·ª≠ d·ª•ng sai m·ª•c ƒë√≠ch.</p>
<blockquote>
<p>Duy tr√¨ t·ª∑ l·ªá gi·ªØa t·ªïng LP token v√† t·ªïng t√†i s·∫£n trong pool</p>
</blockquote>
<h2 id="slippage-truot-gia-la-gi">Slippage (Tr∆∞·ª£t gi√°) l√† g√¨?</h2>
<p>Slippage l√† s·ª± ch√™nh l·ªách gi·ªØa gi√° b·∫°n k·ª≥ v·ªçng v√† gi√° th·ª±c t·∫ø khi giao d·ªãch ƒë∆∞·ª£c th·ª±c thi.
Khi b·∫°n remove liquidity, slippage th∆∞·ªùng ƒë·∫øn t·ª´ bi·∫øn ƒë·ªông gi√° ƒë·ªôt ng·ªôt trong th·ªùi gian ch·ªù giao d·ªãch x√°c nh·∫≠n.</p>
<h2 id="co-che-bao-ve-slippage-hoat-ong-nhu-the-nao">C∆° ch·∫ø b·∫£o v·ªá slippage ho·∫°t ƒë·ªông nh∆∞ th·∫ø n√†o?</h2>
<ol>
<li>B·∫°n ch·ªçn m·ª©c slippage tolerance (v√≠ d·ª•: 5%) tr√™n Dapp</li>
<li>Dapp s·∫Ω t√≠nh to√°n tr∆∞·ªõc min_eth v√† min_tokens d·ª±a theo gi√° hi·ªán t·∫°i v√† m·ª©c slippage ƒë√≥</li>
<li>N·∫øu l∆∞·ª£ng th·ª±c nh·∫≠n th·∫•p h∆°n m·ª©c t·ªëi thi·ªÉu ‚Üí giao d·ªãch s·∫Ω b·ªã revert (th·∫•t b·∫°i)</li>
</ol>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav">
      <a href="../ERC-6551%20Token%20Bound%20Accounts/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../ERC-6551%20Token%20Bound%20Accounts/" class="btn btn-xs btn-link">
        ERC-6551 Token Bound Accounts
      </a>
    </div>
    
  </div>

    <br>
</div>

<div class="giscus-wrapper">
  <div class="giscus"></div>
  <script src="https://giscus.app/client.js"
          data-repo="hien-p/hari-docs"
          data-repo-id="R_kgDOPQrn9w"
          data-category="Announcements"
          data-category-id="DIC_kwDOPQrn984CtVCd"
          data-mapping="title"
          data-strict="0"
          data-reactions-enabled="1"
          data-emit-metadata="1"
          data-input-position="top"
          data-theme="light"
          data-lang="en"
          crossorigin="anonymous"
          async>
  </script>
</div>


<!-- <footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer> -->

</body>
</html>